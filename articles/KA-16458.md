---
title: "AEM 스레드 덤프 분석"
description: 설명
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:11:03 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:13:37 PM"
version-number: 2
article-number: KA-16458
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=e70a8345-6587-eb11-a812-000d3a593216"
exl-id: 74bb70e4-a09b-48fc-8378-96a1736e5ebf
source-git-commit: a59847e2e7e37f432cb01150b9444cd9dbf585df
workflow-type: tm+mt
source-wordcount: '1000'
ht-degree: 0%

---

# AEM 스레드 덤프 분석

## 설명

AEM 분석 [!DNL Java] 를 사용하여 스레드 덤프 [IBM 스레드 분석기](http://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) 도구.

## 해상도

1. 다운로드 및 설치 [IBM 스레드 분석기](https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) (짧게 IBM TDA라고 하겠습니다)
1. 캡처 [스레드 덤프](https://helpx.adobe.com/experience-manager/kb/TakeThreadDump.html) 성능 문제가 발생하는 AEM 인스턴스에서 사용됩니다.
1. IBM TDA에서 스레드 덤프를 엽니다.
1. 스레드 덤프의 세부 정보를 보려면 목록에서 파일을 선택한 다음 &quot;스레드 세부 정보&quot; 단추\*를 클릭합니다.

![tda-threaddetail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1587732783/tda-threaddetail.png "tda-threaddetail")

1. 맨 위에 가장 긴 스택을 사용하여 &quot;스택 깊이&quot;로 정렬합니다.

   ![tda-image1](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image/tda-image1.png)

1. 스택 깊이가 10선 이상인 스레드를 검토합니다.  그것들은 보통 가장 흥미를 끄는 나사이다.  관심 있는 스레드에 대한 메모를 작성합니다.
1. 스레드 &quot;State&quot;로 정렬
1. 아래로 스크롤하여 &quot;실행 가능&quot; 스레드로 이동합니다. 실행 가능한 스레드는 스레드 덤프를 가져올 때 CPU 시간을 적극적으로 사용하고 있는 스레드입니다.

   *참고: 실행 가능 스레드를 검토할 때 [무시할 수 있는 스레드](https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html#ignorethreads) 섹션에 있는 마지막 항목이 될 필요가 없습니다.*

1. 응용 프로그램의 일부인 실행 가능한 스레드(예: 백그라운드 작업 스레드 또는 요청 스레드)를 찾습니다(요청 스레드에는 다음과 같은 이름이 있음). *127.0.0.1 1347028187737 GET /content/sites/global/en/sitemap.static-delivery.httpd.html HTTP/1.1*). 찾으면 하나씩 클릭합니다.

1. 각 요청 스레드에 대해 스레드 이름의 타임스탬프를 보고 사용자의 브라우저가 서버에 요청을 수행한 시간을 확인할 수 있습니다.  예를 들어 위의 스레드 이름에서 타임스탬프(밀리초 unix epoch 형식)는 1347028187737.  다음 도구를 사용하여 그 epoch 번호를 날짜/시간으로 변환할 수 있습니다 [www.epochconverter.com](http://www.epochconverter.com/).  각 스레드 덤프에는 가져온 날짜 및 시간이 표시됩니다.  요청 시간과 스레드 덤프 시간 간의 차이를 사용하여 요청이 활성화된 기간을 확인할 수 있습니다.

1. 요청 스레드를 검토한 후 다른 &quot;실행 가능한&quot; 스레드를 스크롤합니다.  관심 있는 &quot;실행 가능한&quot; 스레드를 찾은 다음 중간 패널인 &quot;대기 중인 스레드&quot;를 확인합니다.  나열된 스레드가 선택한 스레드가 모니터를 해제할 때까지 기다리고 있습니다.  대기 중인 스레드가 표시되지 않으면 선택한 스레드가 여전히 의 소유자일 수 있습니다 [잠금](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) (클래스 구현 참조) [잠금](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) 자세한 내용). 예를 들어, [ReentrantReadWriteLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html) 잠금이 여러 개의 모니터를 내부적으로 구현할 때 잠금 홀더가 어떤 스레드인지 알 수 없습니다.  소스 코드를 확인하여 잠금 홀더일 수 있는 스레드와 일치시켜야 할 수도 있습니다.

1. 스레드에 대기 중인 다른 많은 스레드가 잠금 또는 모니터가 있는 경우 나머지 스레드 덤프를 통해 동일한 문제가 있는 다른 스레드를 찾을 수 있는지 확인하십시오.  다른 덤프에 동일한 스레드가 여전히 있는지 확인합니다(IBM TDA에서는 여러 스레드 덤프를 선택하고 &quot;스레드 비교&quot; 단추\*를 클릭하여 여러 스레드 덤프에서 스레드 상태를 볼 수 있습니다.

   ![tda-compararthreads](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1159496390/tda-comparethreads.png)

1. 아래 스크린샷에서 Collector Service 를 참조하십시오.

   ![tda-Image2](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1730877898/tda-Image2.png)

1. 이 보기에서는 여러 스레드 덤프의 스레드를 확인하여 스레드가 오래 실행 중인지 확인할 수 있습니다.  기본적으로 스레드가 여러 덤프에서 실행 가능한 상태에 있고 스택이 긴 경우, 일반적으로 실행 중인 스레드가 긴 스레드임을 의미합니다.

1. 실행 가능한 스레드를 자세히 찾지 못한 다음 스레드 목록으로 돌아가서 스레드 덤프를 선택한 다음 맨 위 패널에서 &quot;Monitor Detail&quot; 단추\*를 클릭합니다. IBM TDA가 소유 스레드 및 대기 중인 스레드에 대한 모니터 트리 보기를 표시하는 창을 엽니다. 참고: 서블릿 엔진 스레드 풀 모니터와 같은 일부 스레드 풀 스레드가 표시될 수 있으며 유휴 스레드는 무시할 수 있습니다.  대개 스레드는 10개 이하의 스택 라인만 있으므로 유휴 스레드 풀 스레드임을 알 수 있습니다.

![tda-monitor-detail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1106466084/tda-monitordetail.png)

<b>스레드 수준 CPU 사용률([!DNL Linux] 플랫폼 전용):</b>

1. 스레드 덤프 외에 &quot;top -H -b -n1 -p javapid&quot; 출력을 캡처한 경우 스레드 수준 CPU 사용률을 상호 참조할 수 있습니다.  위쪽 출력을 열고 CPU를 사용하는 스레드의 프로세스 ID를 가져옵니다.  프로세스 ID를 16진수로 변환한 다음 해당 스레드 덤프 파일에서 해당 16진수 값을 검색합니다.  ID는 스레드 중 하나의 &quot;nid&quot;와 일치해야 합니다.
1. CPU를 가장 많이 사용하는 일치하는 스레드가 &quot;VM 스레드&quot; 또는 &quot;GC&quot; 스레드인 경우 메모리 문제가 발생할 수 있습니다.  더 많은 스레드 덤프 및 상위 출력에 대해 동일한 연습을 반복하고 이러한 스레드에 CPU 시간이 걸리는 패턴이 있으면 메모리 문제가 발생합니다.
1. 메모리 문제를 확인한 경우 다음에 문제가 발생할 때 더미 덤프를 캡처합니다.  자세한 내용은 [이 문서](https://helpx.adobe.com/experience-manager/kb/AnalyzeMemoryProblems.html) heap 덤프 캡처 및 분석에 대한 자세한 내용을 참조하십시오.

![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)

무시할 수 있는 스레드:

- VM 스레드: VM 시스템 스레드입니다.
- GC 작업 스레드로 시작하는 스레드: 가비지 수집 스레드입니다.
- java.net.PlainSocketImpl.socketAccept(Native Method)에서 -1347028691218과 유사한 이름을 갖는 스레드: 새 연결을 기다리는 서블릿 엔진의 스레드 풀의 스레드입니다.
